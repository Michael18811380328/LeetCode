# 自定义页面的设计

## 数据结构

顶层是一个 app 有下面的属性

| 属性名 | 含义         | 默认值           |
| ------ | ------------ | ---------------- |
| id     | 页面唯一标示 | 'asdf'           |
| layers | 图层数组     | [layer1, layer2] |
|        |              |                  |

lay 对象

类似 PS 不同图层的功能，然后每一个图层可以设置不同的组件和效果（例如透明度）

一个应用限制100个图层

| 属性名 | 含义         | 默认值           |
| ------ | ------------ | ---------------- |
| id     | 图层唯一标示 | 'asdf'           |
| elements | 图层元素     | [element1, element2] |
| Opacity | 图层透明度 | 0——1 可选小数 |
| angle | 图层旋转的角度 | 0-360 |
| z-idnex | 图层的层级 | -999-999 |
|  |  |  |
|  |  |  |

element 对象

element 是一个原子节点，表示界面中某一个节点


| 属性名 | 含义         | 默认值           |
| ------ | ------------ | ---------------- |
| id     | 元素唯一标示 | '65gfjtsbxsmk' |
| elements | 图层元素     | [element1, element2] |
| Opacity | 图层透明度 | 0——1 可选小数 |
| angle | 图层旋转的角度 | 0-360 |
|  |  |  |
|  |  |  |
|  |  |  |



element 元素支持锁定和分组（把若干的元素节点组合成一个部分，主要用来处理拖动和旋转）








## 界面显示

类似 PS 界面

左侧是工具栏，中间时画布，右侧是设置卡片

主要是渲染每一个节点的位置，以及编辑过程

静态的好完成，动态的数据不好实现



## 基本交互

### 整体操作

界面缩放（鼠标事件，或者点击某个按钮）

### 图层操作

设置层级

设置透明度（设置显示隐藏）

### 元素操作

缩放

拖拽

旋转

选中（设置颜色，样式，用户自定义CSS）

### 组合操作

拖拽

旋转



## 存储逻辑

可以设置自动存储，可以用户手动存储

存储不同节点可以存在不同的数据库表中（频繁操作会发送很多数据，且考虑网络的延迟），也可以整体作为 JS 压缩包，存储在一个文件中

如果考虑多人协同，那么就使用每次更改都发请求。如果不考虑多人协同编辑（通常是设计师一个人完成设计工作，那么直接本地编辑，最后保存即可）

是否支持撤销等？如果支持撤销，那么就需要变成每一个 operation，然后写一个撤销的处理函数





## 主要技术栈

react

Raect-dnd

整体是一个 spa 不需要 react-router



